[
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39921",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39921/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39921/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39921/events",
    "html_url": "https://github.com/rails/rails/issues/39921",
    "id": 665167157,
    "node_id": "MDU6SXNzdWU2NjUxNjcxNTc=",
    "number": 39921,
    "title": "Vips::Error: No known saver for '/tmp/image_processing20200724-11554-lsl5p1.jfif'",
    "user": {
      "login": "johan-smits",
      "id": 3228882,
      "node_id": "MDQ6VXNlcjMyMjg4ODI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3228882?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/johan-smits",
      "html_url": "https://github.com/johan-smits",
      "followers_url": "https://api.github.com/users/johan-smits/followers",
      "following_url": "https://api.github.com/users/johan-smits/following{/other_user}",
      "gists_url": "https://api.github.com/users/johan-smits/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/johan-smits/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/johan-smits/subscriptions",
      "organizations_url": "https://api.github.com/users/johan-smits/orgs",
      "repos_url": "https://api.github.com/users/johan-smits/repos",
      "events_url": "https://api.github.com/users/johan-smits/events{/privacy}",
      "received_events_url": "https://api.github.com/users/johan-smits/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-24T13:24:55Z",
    "updated_at": "2020-07-24T13:27:33Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n<!-- (Guidelines for creating a bug report are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#creating-a-bug-report)) -->\r\n```ruby\r\nclass SomeModel < ApplicationRecord\r\n  has_one_attached :file\r\nend\r\n\r\nmodel = SomeModel.create!\r\nmodel.file.attach(io: File.open('image.jfif'), filename: 'image.jfif', content_type: 'image/jpeg')\r\nmodel.file.representation({resize_to_fit: [1920, 1920]}).processed\r\n```\r\n\r\n### Expected behavior\r\nGenerate a representation\r\n\r\n### Actual behavior\r\n```\r\nError:\r\nCollectionTest#test_jfif_file_format:\r\nVips::Error: No known saver for '/tmp/image_processing20200724-11554-lsl5p1.jfif'.\r\n```\r\n\r\n### System configuration\r\n**Rails version**: 6.0.3.1\r\n\r\n**Ruby version**: 2.5.1p57\r\n\r\nUsed image: [image.zip](https://github.com/rails/rails/files/4972128/image.zip)\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39920",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39920/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39920/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39920/events",
    "html_url": "https://github.com/rails/rails/issues/39920",
    "id": 665102983,
    "node_id": "MDU6SXNzdWU2NjUxMDI5ODM=",
    "number": 39920,
    "title": "Inconsistent Getting Started with Rails guide",
    "user": {
      "login": "tlatsas",
      "id": 372440,
      "node_id": "MDQ6VXNlcjM3MjQ0MA==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/372440?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tlatsas",
      "html_url": "https://github.com/tlatsas",
      "followers_url": "https://api.github.com/users/tlatsas/followers",
      "following_url": "https://api.github.com/users/tlatsas/following{/other_user}",
      "gists_url": "https://api.github.com/users/tlatsas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tlatsas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tlatsas/subscriptions",
      "organizations_url": "https://api.github.com/users/tlatsas/orgs",
      "repos_url": "https://api.github.com/users/tlatsas/repos",
      "events_url": "https://api.github.com/users/tlatsas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tlatsas/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-24T11:21:33Z",
    "updated_at": "2020-07-24T11:21:33Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "It seems that @radar started working on an overhaul of the Getting Started guide a while back but only the first (#38268) of the PRs batch (#38328 #38329) got merged. This resulted on the [guide](https://edgeguides.rubyonrails.org/getting_started.html) being inconsistent. More specifically, at the [hello rails section](https://edgeguides.rubyonrails.org/getting_started.html#say-hello-rails) we moved away from introducing a welcome controller, but [later in the guide](https://edgeguides.rubyonrails.org/getting_started.html#setting-the-application-home-page) it is still referenced.\r\n\r\nWhat do you think is the best course of action here? The rest of the work is still there (see stale PRs above), should this be reverted or re-open the rest of the PRs? I can help with proof-reading and squashing/rebasing.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39919",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39919/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39919/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39919/events",
    "html_url": "https://github.com/rails/rails/pull/39919",
    "id": 664794168,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU1OTc1NjM3",
    "number": 39919,
    "title": "Backport ActiveStorage Azure support to 6-0-stable",
    "user": {
      "login": "caius",
      "id": 696,
      "node_id": "MDQ6VXNlcjY5Ng==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/696?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/caius",
      "html_url": "https://github.com/caius",
      "followers_url": "https://api.github.com/users/caius/followers",
      "following_url": "https://api.github.com/users/caius/following{/other_user}",
      "gists_url": "https://api.github.com/users/caius/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/caius/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/caius/subscriptions",
      "organizations_url": "https://api.github.com/users/caius/orgs",
      "repos_url": "https://api.github.com/users/caius/repos",
      "events_url": "https://api.github.com/users/caius/events{/privacy}",
      "received_events_url": "https://api.github.com/users/caius/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 664533972,
        "node_id": "MDU6TGFiZWw2NjQ1MzM5NzI=",
        "url": "https://api.github.com/repos/rails/rails/labels/activestorage",
        "name": "activestorage",
        "color": "bfd4f2",
        "default": false,
        "description": null
      },
      {
        "id": 150377,
        "node_id": "MDU6TGFiZWwxNTAzNzc=",
        "url": "https://api.github.com/repos/rails/rails/labels/docs",
        "name": "docs",
        "color": "02d7e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-23T22:06:16Z",
    "updated_at": "2020-07-23T22:06:20Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39919",
      "html_url": "https://github.com/rails/rails/pull/39919",
      "diff_url": "https://github.com/rails/rails/pull/39919.diff",
      "patch_url": "https://github.com/rails/rails/pull/39919.patch"
    },
    "body": "### Summary\r\n\r\nBackport the work from `master` to `6-0-stable` to make the ActiveStorage `AzureStorage` service easily usable.\r\n\r\nAzure has deprecated the previous `azure-storage` gem since rails 6.0 was released, and split everything into separate gems. @peterzhu2118 has already migrated the `AzureStorageService` on `master` to use the new `azure-storage-blob` gem.\r\n\r\nThis backports that work, and other bugfixes/features in the `AzureStorage` service specifically that don't involve other changes within ActiveStorage (like the `#service_uri` deprecation) as that likely isn't relevant for `6-0-stable` and I don't need in my backport.\r\n\r\nIt also includes Content Disposition headers being included in the S3 and Google Cloud storage services as well. I'm happy to revert these out of this branch if that is an issue.\r\n\r\n### Other Information\r\n\r\nThe PRs that originally applied these changes to master are:\r\n\r\n* https://github.com/rails/rails/pull/36715\r\n* https://github.com/rails/rails/pull/36792\r\n* https://github.com/rails/rails/pull/36866\r\n* https://github.com/rails/rails/pull/36793\r\n* https://github.com/rails/rails/pull/38747\r\n\r\n_(I'm not sure if this is the done thing for backporting work, apologies if it isn't and please just close this in that case!)_",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39918",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39918/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39918/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39918/events",
    "html_url": "https://github.com/rails/rails/issues/39918",
    "id": 664697637,
    "node_id": "MDU6SXNzdWU2NjQ2OTc2Mzc=",
    "number": 39918,
    "title": "ActiveStorage redirect url does not account for relative root ",
    "user": {
      "login": "farhatahmad",
      "id": 35435341,
      "node_id": "MDQ6VXNlcjM1NDM1MzQx",
      "avatar_url": "https://avatars2.githubusercontent.com/u/35435341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/farhatahmad",
      "html_url": "https://github.com/farhatahmad",
      "followers_url": "https://api.github.com/users/farhatahmad/followers",
      "following_url": "https://api.github.com/users/farhatahmad/following{/other_user}",
      "gists_url": "https://api.github.com/users/farhatahmad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/farhatahmad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/farhatahmad/subscriptions",
      "organizations_url": "https://api.github.com/users/farhatahmad/orgs",
      "repos_url": "https://api.github.com/users/farhatahmad/repos",
      "events_url": "https://api.github.com/users/farhatahmad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/farhatahmad/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-23T18:57:34Z",
    "updated_at": "2020-07-23T18:58:47Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n\r\n1. Add a relative root to your application (`config.relative_url_root = \"/test` in your `development.rb` file)\r\n2. Setup ActiveStorage \r\n3. Create a model with `has_one_attached :image`\r\n4. Attach a file using file upload\r\n5. Call `rails_blob_url(model.image)`\r\n\r\n### Expected behavior\r\nIt should return a link to the attached image\r\n\r\n### Actual behavior\r\nThe initial URL is in the correct form `http://example.com/test/rails/active_storage/......` but once that link is clicked, the link redirects to `http://example.com/rails/active_storage/......` (note the missing relative root).\r\n\r\nIn situations where multiple applications are present on the same system, this causes the url to return a 404\r\n\r\n### System configuration\r\n**Rails version**: 5.2.4.3\r\n\r\n**Ruby version**: 2.5.1\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39915",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39915/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39915/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39915/events",
    "html_url": "https://github.com/rails/rails/pull/39915",
    "id": 664504465,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU1NzM0Mzg5",
    "number": 39915,
    "title": "Add rails routes separated format option",
    "user": {
      "login": "sakuraineed",
      "id": 4065624,
      "node_id": "MDQ6VXNlcjQwNjU2MjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4065624?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sakuraineed",
      "html_url": "https://github.com/sakuraineed",
      "followers_url": "https://api.github.com/users/sakuraineed/followers",
      "following_url": "https://api.github.com/users/sakuraineed/following{/other_user}",
      "gists_url": "https://api.github.com/users/sakuraineed/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sakuraineed/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sakuraineed/subscriptions",
      "organizations_url": "https://api.github.com/users/sakuraineed/orgs",
      "repos_url": "https://api.github.com/users/sakuraineed/repos",
      "events_url": "https://api.github.com/users/sakuraineed/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sakuraineed/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107189,
        "node_id": "MDU6TGFiZWwxMDcxODk=",
        "url": "https://api.github.com/repos/rails/rails/labels/actionpack",
        "name": "actionpack",
        "color": "FFF700",
        "default": false,
        "description": null
      },
      {
        "id": 150377,
        "node_id": "MDU6TGFiZWwxNTAzNzc=",
        "url": "https://api.github.com/repos/rails/rails/labels/docs",
        "name": "docs",
        "color": "02d7e1",
        "default": false,
        "description": null
      },
      {
        "id": 107195,
        "node_id": "MDU6TGFiZWwxMDcxOTU=",
        "url": "https://api.github.com/repos/rails/rails/labels/railties",
        "name": "railties",
        "color": "8BE06E",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-23T14:08:48Z",
    "updated_at": "2020-07-23T14:08:51Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39915",
      "html_url": "https://github.com/rails/rails/pull/39915",
      "diff_url": "https://github.com/rails/rails/pull/39915.diff",
      "patch_url": "https://github.com/rails/rails/pull/39915.patch"
    },
    "body": "### Summary\r\n\r\nInstead of `bin/rails routes` outputs routes in a row, `bin/rails routes --separated` outputs routes separated by empty line between each controller routes to make more readable.\r\n\r\nAnd rails routes options cannot be both expanded (-E) and separated (-s).\r\n\r\n### Other Information\r\n\r\nsample config/routes.rb\r\n\r\n```rb\r\nRails.application.routes.draw do\r\n  root 'pages#root'\r\n\r\n  get '/pages/:id', to: 'pages#show'\r\n\r\n  resource :admin\r\n  resource :path_to_admin, controller: 'admins', only: %i[show]\r\n\r\n  resources :users do\r\n    member do\r\n      get 'member'\r\n    end\r\n    collection do\r\n      get 'collection'\r\n    end\r\n  end\r\n\r\n  namespace :namespace do\r\n    resources :users\r\n  end\r\n\r\n  get ':controller/:action/:id'\r\n\r\n  get '/redirect_from', to: redirect('/redirect_to')\r\nend\r\n```\r\n\r\nrails routes separated output\r\n\r\n```bash\r\n$ bin/rails routes -s\r\n                                  Prefix Verb   URI Pattern                                                                                       Controller#Action\r\n                                    root GET    /                                                                                                 pages#root\r\n                                         GET    /pages/:id(.:format)                                                                              pages#show\r\n\r\n                               new_admin GET    /admin/new(.:format)                                                                              admins#new\r\n                              edit_admin GET    /admin/edit(.:format)                                                                             admins#edit\r\n                                   admin GET    /admin(.:format)                                                                                  admins#show\r\n                                         PATCH  /admin(.:format)                                                                                  admins#update\r\n                                         PUT    /admin(.:format)                                                                                  admins#update\r\n                                         DELETE /admin(.:format)                                                                                  admins#destroy\r\n                                         POST   /admin(.:format)                                                                                  admins#create\r\n                           path_to_admin GET    /path_to_admin(.:format)                                                                          admins#show\r\n\r\n                             member_user GET    /users/:id/member(.:format)                                                                       users#member\r\n                        collection_users GET    /users/collection(.:format)                                                                       users#collection\r\n                                   users GET    /users(.:format)                                                                                  users#index\r\n                                         POST   /users(.:format)                                                                                  users#create\r\n                                new_user GET    /users/new(.:format)                                                                              users#new\r\n                               edit_user GET    /users/:id/edit(.:format)                                                                         users#edit\r\n                                    user GET    /users/:id(.:format)                                                                              users#show\r\n                                         PATCH  /users/:id(.:format)                                                                              users#update\r\n                                         PUT    /users/:id(.:format)                                                                              users#update\r\n                                         DELETE /users/:id(.:format)                                                                              users#destroy\r\n\r\n                         namespace_users GET    /namespace/users(.:format)                                                                        namespace/users#index\r\n                                         POST   /namespace/users(.:format)                                                                        namespace/users#create\r\n                      new_namespace_user GET    /namespace/users/new(.:format)                                                                    namespace/users#new\r\n                     edit_namespace_user GET    /namespace/users/:id/edit(.:format)                                                               namespace/users#edit\r\n                          namespace_user GET    /namespace/users/:id(.:format)                                                                    namespace/users#show\r\n                                         PATCH  /namespace/users/:id(.:format)                                                                    namespace/users#update\r\n                                         PUT    /namespace/users/:id(.:format)                                                                    namespace/users#update\r\n                                         DELETE /namespace/users/:id(.:format)                                                                    namespace/users#destroy\r\n\r\n                                         GET    /:controller/:action/:id(.:format)                                                                :controller#:action\r\n\r\n                           redirect_from GET    /redirect_from(.:format)                                                                          redirect(301, /redirect_to)\r\n\r\n           rails_postmark_inbound_emails POST   /rails/action_mailbox/postmark/inbound_emails(.:format)                                           action_mailbox/ingresses/postmark/inbound_emails#create\r\n\r\n              rails_relay_inbound_emails POST   /rails/action_mailbox/relay/inbound_emails(.:format)                                              action_mailbox/ingresses/relay/inbound_emails#create\r\n\r\n           rails_sendgrid_inbound_emails POST   /rails/action_mailbox/sendgrid/inbound_emails(.:format)                                           action_mailbox/ingresses/sendgrid/inbound_emails#create\r\n\r\n     rails_mandrill_inbound_health_check GET    /rails/action_mailbox/mandrill/inbound_emails(.:format)                                           action_mailbox/ingresses/mandrill/inbound_emails#health_check\r\n           rails_mandrill_inbound_emails POST   /rails/action_mailbox/mandrill/inbound_emails(.:format)                                           action_mailbox/ingresses/mandrill/inbound_emails#create\r\n\r\n            rails_mailgun_inbound_emails POST   /rails/action_mailbox/mailgun/inbound_emails/mime(.:format)                                       action_mailbox/ingresses/mailgun/inbound_emails#create\r\n\r\n          rails_conductor_inbound_emails GET    /rails/conductor/action_mailbox/inbound_emails(.:format)                                          rails/conductor/action_mailbox/inbound_emails#index\r\n                                         POST   /rails/conductor/action_mailbox/inbound_emails(.:format)                                          rails/conductor/action_mailbox/inbound_emails#create\r\n       new_rails_conductor_inbound_email GET    /rails/conductor/action_mailbox/inbound_emails/new(.:format)                                      rails/conductor/action_mailbox/inbound_emails#new\r\n      edit_rails_conductor_inbound_email GET    /rails/conductor/action_mailbox/inbound_emails/:id/edit(.:format)                                 rails/conductor/action_mailbox/inbound_emails#edit\r\n           rails_conductor_inbound_email GET    /rails/conductor/action_mailbox/inbound_emails/:id(.:format)                                      rails/conductor/action_mailbox/inbound_emails#show\r\n                                         PATCH  /rails/conductor/action_mailbox/inbound_emails/:id(.:format)                                      rails/conductor/action_mailbox/inbound_emails#update\r\n                                         PUT    /rails/conductor/action_mailbox/inbound_emails/:id(.:format)                                      rails/conductor/action_mailbox/inbound_emails#update\r\n                                         DELETE /rails/conductor/action_mailbox/inbound_emails/:id(.:format)                                      rails/conductor/action_mailbox/inbound_emails#destroy\r\n\r\nnew_rails_conductor_inbound_email_source GET    /rails/conductor/action_mailbox/inbound_emails/sources/new(.:format)                              rails/conductor/action_mailbox/inbound_emails/sources#new\r\n   rails_conductor_inbound_email_sources POST   /rails/conductor/action_mailbox/inbound_emails/sources(.:format)                                  rails/conductor/action_mailbox/inbound_emails/sources#create\r\n\r\n   rails_conductor_inbound_email_reroute POST   /rails/conductor/action_mailbox/:inbound_email_id/reroute(.:format)                               rails/conductor/action_mailbox/reroutes#create\r\n\r\n                      rails_service_blob GET    /rails/active_storage/blobs/redirect/:signed_id/*filename(.:format)                               active_storage/blobs/redirect#show\r\n\r\n                rails_service_blob_proxy GET    /rails/active_storage/blobs/proxy/:signed_id/*filename(.:format)                                  active_storage/blobs/proxy#show\r\n\r\n                                         GET    /rails/active_storage/blobs/:signed_id/*filename(.:format)                                        active_storage/blobs/redirect#show\r\n\r\n               rails_blob_representation GET    /rails/active_storage/representations/redirect/:signed_blob_id/:variation_key/*filename(.:format) active_storage/representations/redirect#show\r\n\r\n         rails_blob_representation_proxy GET    /rails/active_storage/representations/proxy/:signed_blob_id/:variation_key/*filename(.:format)    active_storage/representations/proxy#show\r\n\r\n                                         GET    /rails/active_storage/representations/:signed_blob_id/:variation_key/*filename(.:format)          active_storage/representations/redirect#show\r\n\r\n                      rails_disk_service GET    /rails/active_storage/disk/:encoded_key/*filename(.:format)                                       active_storage/disk#show\r\n               update_rails_disk_service PUT    /rails/active_storage/disk/:encoded_token(.:format)                                               active_storage/disk#update\r\n\r\n                    rails_direct_uploads POST   /rails/active_storage/direct_uploads(.:format)                                                    active_storage/direct_uploads#create\r\n```\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39913",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39913/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39913/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39913/events",
    "html_url": "https://github.com/rails/rails/issues/39913",
    "id": 664405668,
    "node_id": "MDU6SXNzdWU2NjQ0MDU2Njg=",
    "number": 39913,
    "title": "action_text using active_admin won't work properly",
    "user": {
      "login": "aditya2muley",
      "id": 53964800,
      "node_id": "MDQ6VXNlcjUzOTY0ODAw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/53964800?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aditya2muley",
      "html_url": "https://github.com/aditya2muley",
      "followers_url": "https://api.github.com/users/aditya2muley/followers",
      "following_url": "https://api.github.com/users/aditya2muley/following{/other_user}",
      "gists_url": "https://api.github.com/users/aditya2muley/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aditya2muley/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aditya2muley/subscriptions",
      "organizations_url": "https://api.github.com/users/aditya2muley/orgs",
      "repos_url": "https://api.github.com/users/aditya2muley/repos",
      "events_url": "https://api.github.com/users/aditya2muley/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aditya2muley/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 3,
    "created_at": "2020-07-23T11:40:28Z",
    "updated_at": "2020-07-24T15:27:44Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": " am using active admin and active text with rails 6 when I inserted image inside `rich_text_area` using active admin `(f.rich_text_area)` then it appears inside text area immediately but when I tried to save the same then in log file I found `img tag` is not included in parameter. so when I press edit button of article then no image appears.\r\n\r\nI have successfully install active_storage and active_text please find below details\r\n\r\n\r\nmodel:\r\n```rb\r\nclass Article < ApplicationRecord\r\n  belongs_to :category\r\n  has_rich_text :body\r\nend\r\n\r\nadmin/article.rb:\r\nform do |f|\r\n    f.inputs do\r\n      f.input :title\r\n      f.rich_text_area :body\r\n    end\r\n    f.actions\r\n  end\r\n```\r\n\r\nadding image to text_area and after saving the data will produce log :-\r\n```rb\r\nParameters: {\"authenticity_token\"=>\"xxxxxxxxxxxxxx\", \"article\"=>{\"title\"=>\"bccvb\",  \"body\"=>\"<div></div>\"}\r\n```\r\n\r\nno image, if you edit then also you find there is no image",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39912",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39912/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39912/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39912/events",
    "html_url": "https://github.com/rails/rails/issues/39912",
    "id": 664247365,
    "node_id": "MDU6SXNzdWU2NjQyNDczNjU=",
    "number": 39912,
    "title": "after_commit is called after RELEASE SAVEPOINT",
    "user": {
      "login": "yskkin",
      "id": 5965113,
      "node_id": "MDQ6VXNlcjU5NjUxMTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5965113?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yskkin",
      "html_url": "https://github.com/yskkin",
      "followers_url": "https://api.github.com/users/yskkin/followers",
      "following_url": "https://api.github.com/users/yskkin/following{/other_user}",
      "gists_url": "https://api.github.com/users/yskkin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yskkin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yskkin/subscriptions",
      "organizations_url": "https://api.github.com/users/yskkin/orgs",
      "repos_url": "https://api.github.com/users/yskkin/repos",
      "events_url": "https://api.github.com/users/yskkin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yskkin/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107191,
        "node_id": "MDU6TGFiZWwxMDcxOTE=",
        "url": "https://api.github.com/repos/rails/rails/labels/activerecord",
        "name": "activerecord",
        "color": "0b02e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-23T07:02:56Z",
    "updated_at": "2020-07-24T11:57:29Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n<!-- (Guidelines for creating a bug report are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#creating-a-bug-report)) -->\r\n\r\n```ruby\r\n# frozen_string_literal: true\r\n\r\nrequire \"bundler/inline\"\r\n\r\ngemfile(true) do\r\n  source \"https://rubygems.org\"\r\n\r\n  git_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\n  gem \"rails\", github: \"rails/rails\"\r\n  gem \"sqlite3\"\r\nend\r\n\r\nrequire \"active_record\"\r\nrequire \"minitest/autorun\"\r\nrequire \"logger\"\r\n\r\n# This connection will do for database-independent bug reports.\r\nActiveRecord::Base.establish_connection(adapter: \"sqlite3\", database: \":memory:\")\r\nActiveRecord::Base.logger = Logger.new(STDOUT)\r\n\r\nActiveRecord::Schema.define do\r\n  create_table :posts, force: true do |t|\r\n  end\r\nend\r\n\r\nclass Post < ActiveRecord::Base\r\n  after_commit :after_commit\r\n\r\n  def after_commit\r\n    p 'after commit'\r\n  end\r\nend\r\n\r\nclass BugTest < Minitest::Test\r\n  def test_association_stuff\r\n    Post.transaction(joinable: false) do\r\n      Post.transaction do\r\n        Post.create!\r\n      end\r\n    end\r\n  end\r\nend\r\n```\r\n\r\n### Expected behavior\r\n<!-- Tell us what should happen -->\r\n\r\n\"after commit\" is outputted after COMMIT statement.\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead -->\r\n\r\n\"after commit\" is outputted after RELEASE SAVEPOINT and before COMMIT statement.\r\n\r\n```\r\n# Running:\r\n\r\nD, [2020-07-23T11:28:41.268893 #72669] DEBUG -- :   TRANSACTION (0.0ms)  begin transaction\r\nD, [2020-07-23T11:28:41.269115 #72669] DEBUG -- :   TRANSACTION (0.1ms)  SAVEPOINT active_record_1\r\nD, [2020-07-23T11:28:41.270360 #72669] DEBUG -- :   Post Create (0.1ms)  INSERT INTO \"posts\" DEFAULT VALUES\r\nD, [2020-07-23T11:28:41.270500 #72669] DEBUG -- :   TRANSACTION (0.0ms)  RELEASE SAVEPOINT active_record_1\r\n\"after commit\"\r\nD, [2020-07-23T11:28:41.270740 #72669] DEBUG -- :   TRANSACTION (0.1ms)  commit transaction\r\n.\r\n\r\nFinished in 0.002930s, 341.2969 runs/s, 0.0000 assertions/s.\r\n1 runs, 0 assertions, 0 failures, 0 errors, 0 skips\r\n```\r\n\r\n### System configuration\r\n**Rails version**:\r\n\r\n**Ruby version**:\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39911",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39911/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39911/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39911/events",
    "html_url": "https://github.com/rails/rails/issues/39911",
    "id": 664047066,
    "node_id": "MDU6SXNzdWU2NjQwNDcwNjY=",
    "number": 39911,
    "title": "Action Text only usable with integer PKs",
    "user": {
      "login": "ekampp",
      "id": 40206,
      "node_id": "MDQ6VXNlcjQwMjA2",
      "avatar_url": "https://avatars3.githubusercontent.com/u/40206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekampp",
      "html_url": "https://github.com/ekampp",
      "followers_url": "https://api.github.com/users/ekampp/followers",
      "following_url": "https://api.github.com/users/ekampp/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekampp/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekampp/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekampp/subscriptions",
      "organizations_url": "https://api.github.com/users/ekampp/orgs",
      "repos_url": "https://api.github.com/users/ekampp/repos",
      "events_url": "https://api.github.com/users/ekampp/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekampp/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-22T21:00:17Z",
    "updated_at": "2020-07-22T21:00:17Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n\r\n1. Follow the [ActionText guide](https://edgeguides.rubyonrails.org/action_text_overview.html) and then using the [`with_rich_text_<column>` method](https://edgeguides.rubyonrails.org/action_text_overview.html#avoid-n-1-queries).\r\n\r\n### Expected behavior\r\n\r\nThis should work with non-integer primary keys (e.g. UUIDs)\r\n\r\n### Actual behavior\r\n\r\nIt does not work with UUID primary keys and raises this exception:\r\n\r\n```\r\nActiveRecord::StatementInvalid (PG::UndefinedFunction: ERROR:  operator does not exist: bigint = uuid\r\nLINE 1: ...me\" = $2 AND \"action_text_rich_texts\".\"record_id\" = \"table...\r\n                                                             ^\r\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\r\n):\r\n```\r\n\r\n### System configuration\r\n**Rails version**: 6.0.3.2\r\n\r\n**Ruby version**: 2.7.1\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39910",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39910/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39910/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39910/events",
    "html_url": "https://github.com/rails/rails/issues/39910",
    "id": 664021065,
    "node_id": "MDU6SXNzdWU2NjQwMjEwNjU=",
    "number": 39910,
    "title": "Rails.application.secrets.secret_key_base empty on production",
    "user": {
      "login": "Aryk",
      "id": 525212,
      "node_id": "MDQ6VXNlcjUyNTIxMg==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/525212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aryk",
      "html_url": "https://github.com/Aryk",
      "followers_url": "https://api.github.com/users/Aryk/followers",
      "following_url": "https://api.github.com/users/Aryk/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aryk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aryk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aryk/subscriptions",
      "organizations_url": "https://api.github.com/users/Aryk/orgs",
      "repos_url": "https://api.github.com/users/Aryk/repos",
      "events_url": "https://api.github.com/users/Aryk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aryk/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-22T20:13:28Z",
    "updated_at": "2020-07-24T10:53:13Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce:\r\n\r\n1) Run your server in production with env variable SECRET_KEY_BASE=foobar\r\n2) Rails.application.secret_key_base will be \"foobar\"...however\r\n3) Rails.application.secrets.secret_key_base will be nil.\r\n \r\n### Expected behavior\r\nRails.application.secrets.secret_key_base should be equal to \"foobar\" just like it behaves in development and test. I discovered this issue in production which was hard to debug because I was passing through the environment variable correctly but only the Rails.application.secret_key_base was getting populated.\r\n\r\nPerhaps this is expected behavior but if it is, could someone clarify the logic of magically having the fallback in development and then surprising a developer in production?  \r\n\r\nCode in question [here](https://github.com/rails/rails/blob/master/railties/lib/rails/application.rb#L436)\r\n\r\nRails version 6.\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39909",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39909/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39909/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39909/events",
    "html_url": "https://github.com/rails/rails/issues/39909",
    "id": 663992253,
    "node_id": "MDU6SXNzdWU2NjM5OTIyNTM=",
    "number": 39909,
    "title": "Can 'rails console' pass '--nomultiline' to IRB?",
    "user": {
      "login": "dgutov",
      "id": 271877,
      "node_id": "MDQ6VXNlcjI3MTg3Nw==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/271877?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgutov",
      "html_url": "https://github.com/dgutov",
      "followers_url": "https://api.github.com/users/dgutov/followers",
      "following_url": "https://api.github.com/users/dgutov/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgutov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgutov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgutov/subscriptions",
      "organizations_url": "https://api.github.com/users/dgutov/orgs",
      "repos_url": "https://api.github.com/users/dgutov/repos",
      "events_url": "https://api.github.com/users/dgutov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgutov/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-22T19:18:58Z",
    "updated_at": "2020-07-22T19:18:58Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "Since there is no environment variable that would affect IRB's editor module in latest versions, the only way to disable the \"multiline\" stuff is by passing `--nomultiline` as an argument to it.\r\n\r\n`rails console` could handle such arguments and set `IRB.conf[:USE_MULTILINE] = false`, for instance.\r\n\r\nAlso see https://github.com/ruby/irb/issues/113.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39908",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39908/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39908/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39908/events",
    "html_url": "https://github.com/rails/rails/pull/39908",
    "id": 663919640,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU1MjQ3ODU0",
    "number": 39908,
    "title": "Fix ArgumentError (or TypeError) when ActiveStorage::Blob initialized through nested attributes",
    "user": {
      "login": "choznerol",
      "id": 12410942,
      "node_id": "MDQ6VXNlcjEyNDEwOTQy",
      "avatar_url": "https://avatars2.githubusercontent.com/u/12410942?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/choznerol",
      "html_url": "https://github.com/choznerol",
      "followers_url": "https://api.github.com/users/choznerol/followers",
      "following_url": "https://api.github.com/users/choznerol/following{/other_user}",
      "gists_url": "https://api.github.com/users/choznerol/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/choznerol/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/choznerol/subscriptions",
      "organizations_url": "https://api.github.com/users/choznerol/orgs",
      "repos_url": "https://api.github.com/users/choznerol/repos",
      "events_url": "https://api.github.com/users/choznerol/events{/privacy}",
      "received_events_url": "https://api.github.com/users/choznerol/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 664533972,
        "node_id": "MDU6TGFiZWw2NjQ1MzM5NzI=",
        "url": "https://api.github.com/repos/rails/rails/labels/activestorage",
        "name": "activestorage",
        "color": "bfd4f2",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-22T17:12:23Z",
    "updated_at": "2020-07-23T00:19:13Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39908",
      "html_url": "https://github.com/rails/rails/pull/39908",
      "diff_url": "https://github.com/rails/rails/pull/39908.diff",
      "patch_url": "https://github.com/rails/rails/pull/39908.patch"
    },
    "body": "### Summary\r\n\r\nFix #37411\r\n\r\n@metheglin described the scenario in detail in #37411 and pointed out the root cause.\r\n\r\nIn short, `attachable` could be an `ActiveSupport::HashWithIndifferentAccess` instead of a simple `Hash` when using with nested attributes.  Because `ActiveSupport::HashWithIndifferentAccess` store its key as `String` (instead of Symbol) so it won't map to `build_after_unfurling`'s kwargs.\r\n\r\nBefore https://github.com/rails/rails/commit/dea19d4ead79fe0d7a1c81eb0be1c8958c80659e , the error will be:\r\n```\r\nArgumentError (wrong number of arguments (given 1, expected 0; required keywords: io, filename))\r\n```\r\n\r\nAfter https://github.com/rails/rails/commit/dea19d4ead79fe0d7a1c81eb0be1c8958c80659e , the error will be something like: \r\n```\r\nTypeError: hash key \"record\" is not a Symbol\r\n```\r\n\r\n### Other Information\r\n\r\nThe [added test](https://github.com/rails/rails/pull/39908/files#diff-164f255eaa0009a51c647e92ab27f916R322) case will fail this way without [the fix](https://github.com/rails/rails/pull/39908/files#diff-4812e33629a9ccb43c37f3430085dc34R68):\r\n<img width=\"1333\" alt=\"Screen Shot 2020-07-23 at 12 46 52 AM\" src=\"https://user-images.githubusercontent.com/12410942/88205127-e5b4d300-cc7e-11ea-847a-053f5fc798d5.png\">\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39906",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39906/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39906/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39906/events",
    "html_url": "https://github.com/rails/rails/pull/39906",
    "id": 663846121,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU1MTg3OTMx",
    "number": 39906,
    "title": "Ensures Calculate methods work with order and limit.",
    "user": {
      "login": "PhilCoggins",
      "id": 2223408,
      "node_id": "MDQ6VXNlcjIyMjM0MDg=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2223408?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PhilCoggins",
      "html_url": "https://github.com/PhilCoggins",
      "followers_url": "https://api.github.com/users/PhilCoggins/followers",
      "following_url": "https://api.github.com/users/PhilCoggins/following{/other_user}",
      "gists_url": "https://api.github.com/users/PhilCoggins/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PhilCoggins/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PhilCoggins/subscriptions",
      "organizations_url": "https://api.github.com/users/PhilCoggins/orgs",
      "repos_url": "https://api.github.com/users/PhilCoggins/repos",
      "events_url": "https://api.github.com/users/PhilCoggins/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PhilCoggins/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107191,
        "node_id": "MDU6TGFiZWwxMDcxOTE=",
        "url": "https://api.github.com/repos/rails/rails/labels/activerecord",
        "name": "activerecord",
        "color": "0b02e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-22T15:21:05Z",
    "updated_at": "2020-07-22T15:31:25Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39906",
      "html_url": "https://github.com/rails/rails/pull/39906",
      "diff_url": "https://github.com/rails/rails/pull/39906.diff",
      "patch_url": "https://github.com/rails/rails/pull/39906.patch"
    },
    "body": "### Summary\r\n\r\n<!-- Provide a general description of the code changes in your pull\r\nrequest... were there any bugs you had fixed? If so, mention them. If\r\nthese bugs have open GitHub issues, be sure to tag them here as well,\r\nto keep the conversation linked together. -->\r\n* Use two queries to obtain actual calculation aggregates. First query\r\nfetches the IDs of the actual order / limit query, the second query\r\nignores the order clause and uses a where query to filter results\r\ncorrectly.\r\n\r\n* This is similar to the behavior used when the Relation contains eager\r\nloaded values.\r\n\r\nFixes https://github.com/rails/rails/issues/39900\r\n### Other Information\r\n\r\n<!-- If there's anything else that's important and relevant to your pull\r\nrequest, mention that information here. This could include\r\nbenchmarks, or other information.\r\n\r\nIf you are updating any of the CHANGELOG files or are asked to update the\r\nCHANGELOG files by reviewers, please add the CHANGELOG entry at the top of the file.\r\n\r\nFinally, if your pull request affects documentation or any non-code\r\nchanges, guidelines for those changes are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation)\r\n\r\nThanks for contributing to Rails! -->\r\n\r\nI am unsure what the upstream implications to this change could be, so please review carefully.\r\n\r\nThe logic used here is nearly identical to the logic used when a Calculate method is issued against a relation containing eager loading values:\r\n```ruby\r\n# Incorrect SQL, it drops the order clause, which will return an indeterminate result set:\r\nirb(main):002:0> Post.order(id: :desc).limit(5).average(:comments_count)\r\n   (0.3ms)  SELECT AVG(\"posts\".\"comments_count\") FROM \"posts\" LIMIT ?  [[\"LIMIT\", 5]]\r\n\r\n# Correct SQL, uses two queries to perform the aggregation on the correct records:\r\nirb(main):003:0> Post.includes(:comments).order(id: :desc).limit(5).average(:comments_count)\r\n  SQL (0.2ms)  SELECT DISTINCT \"posts\".\"id\" FROM \"posts\" LEFT OUTER JOIN \"comments\" ON \"comments\".\"post_id\" = \"posts\".\"id\" ORDER BY \"posts\".\"id\" DESC LIMIT ?  [[\"LIMIT\", 5]]\r\n   (0.7ms)  SELECT AVG(\"posts\".\"comments_count\") FROM \"posts\" LEFT OUTER JOIN \"comments\" ON \"comments\".\"post_id\" = \"posts\".\"id\" WHERE \"posts\".\"id\" IN (?, ?, ?, ?, ?)  [[\"id\", 101], [\"id\", 100], [\"id\", 99], [\"id\", 98], [\"id\", 97]]\r\n```",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39905",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39905/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39905/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39905/events",
    "html_url": "https://github.com/rails/rails/pull/39905",
    "id": 663746924,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU1MTA2NTE4",
    "number": 39905,
    "title": "Remove double negative in testing docs [ci-skip]",
    "user": {
      "login": "mehagar",
      "id": 7461705,
      "node_id": "MDQ6VXNlcjc0NjE3MDU=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7461705?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehagar",
      "html_url": "https://github.com/mehagar",
      "followers_url": "https://api.github.com/users/mehagar/followers",
      "following_url": "https://api.github.com/users/mehagar/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehagar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehagar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehagar/subscriptions",
      "organizations_url": "https://api.github.com/users/mehagar/orgs",
      "repos_url": "https://api.github.com/users/mehagar/repos",
      "events_url": "https://api.github.com/users/mehagar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehagar/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 150377,
        "node_id": "MDU6TGFiZWwxNTAzNzc=",
        "url": "https://api.github.com/repos/rails/rails/labels/docs",
        "name": "docs",
        "color": "02d7e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-22T13:05:37Z",
    "updated_at": "2020-07-22T13:40:41Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39905",
      "html_url": "https://github.com/rails/rails/pull/39905",
      "diff_url": "https://github.com/rails/rails/pull/39905.diff",
      "patch_url": "https://github.com/rails/rails/pull/39905.patch"
    },
    "body": "### Summary\r\n\r\nI found this alternative description easier to understand since it doesn't use a double negative.\r\n\r\n### Other Information\r\n\r\n<!-- If there's anything else that's important and relevant to your pull\r\nrequest, mention that information here. This could include\r\nbenchmarks, or other information.\r\n\r\nIf you are updating any of the CHANGELOG files or are asked to update the\r\nCHANGELOG files by reviewers, please add the CHANGELOG entry at the top of the file.\r\n\r\nFinally, if your pull request affects documentation or any non-code\r\nchanges, guidelines for those changes are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation)\r\n\r\nThanks for contributing to Rails! -->\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39901",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39901/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39901/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39901/events",
    "html_url": "https://github.com/rails/rails/pull/39901",
    "id": 663382673,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU0ODA3NzUx",
    "number": 39901,
    "title": "Add back support for other syntax highlighting [skip-ci]",
    "user": {
      "login": "gerrywastaken",
      "id": 71481,
      "node_id": "MDQ6VXNlcjcxNDgx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/71481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gerrywastaken",
      "html_url": "https://github.com/gerrywastaken",
      "followers_url": "https://api.github.com/users/gerrywastaken/followers",
      "following_url": "https://api.github.com/users/gerrywastaken/following{/other_user}",
      "gists_url": "https://api.github.com/users/gerrywastaken/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gerrywastaken/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gerrywastaken/subscriptions",
      "organizations_url": "https://api.github.com/users/gerrywastaken/orgs",
      "repos_url": "https://api.github.com/users/gerrywastaken/repos",
      "events_url": "https://api.github.com/users/gerrywastaken/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gerrywastaken/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 150377,
        "node_id": "MDU6TGFiZWwxNTAzNzc=",
        "url": "https://api.github.com/repos/rails/rails/labels/docs",
        "name": "docs",
        "color": "02d7e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-22T00:07:21Z",
    "updated_at": "2020-07-23T23:32:36Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39901",
      "html_url": "https://github.com/rails/rails/pull/39901",
      "diff_url": "https://github.com/rails/rails/pull/39901.diff",
      "patch_url": "https://github.com/rails/rails/pull/39901.patch"
    },
    "body": "### Summary\r\nWe recently switched to use Rouge for syntax highlighting in the guides,\r\nbut in doing so we dropped support for highlighting the following\r\nsyntaxes, which are used in the guides:\r\n\r\napache\r\ndiff\r\njson\r\nmarkdown\r\nnginx\r\nscss\r\nxml\r\n\r\nThere was also css and the \"javascript\" alias, but @eugeneius already\r\naddressed these two.\r\n\r\nThese syntaxes were all being converted to \"plaintext\". This change allows\r\nall the lexers mentioned above as well as any other lexers available\r\nthrough Rouge. This makes it easier for anybody needing to include a\r\nsyntax we didn't think of and allows for more custom lexer options when\r\nnecessary.\r\n\r\nCheers :)",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39900",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39900/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39900/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39900/events",
    "html_url": "https://github.com/rails/rails/issues/39900",
    "id": 663351237,
    "node_id": "MDU6SXNzdWU2NjMzNTEyMzc=",
    "number": 39900,
    "title": "#calculate aggregates do not respect order",
    "user": {
      "login": "PhilCoggins",
      "id": 2223408,
      "node_id": "MDQ6VXNlcjIyMjM0MDg=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2223408?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PhilCoggins",
      "html_url": "https://github.com/PhilCoggins",
      "followers_url": "https://api.github.com/users/PhilCoggins/followers",
      "following_url": "https://api.github.com/users/PhilCoggins/following{/other_user}",
      "gists_url": "https://api.github.com/users/PhilCoggins/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PhilCoggins/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PhilCoggins/subscriptions",
      "organizations_url": "https://api.github.com/users/PhilCoggins/orgs",
      "repos_url": "https://api.github.com/users/PhilCoggins/repos",
      "events_url": "https://api.github.com/users/PhilCoggins/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PhilCoggins/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-21T22:36:03Z",
    "updated_at": "2020-07-21T23:13:12Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n<!-- (Guidelines for creating a bug report are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#creating-a-bug-report)) -->\r\n```\r\n# frozen_string_literal: true\r\n\r\nrequire \"bundler/inline\"\r\n\r\ngemfile(true) do\r\n  source \"https://rubygems.org\"\r\n\r\n  git_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\n  gem \"rails\", github: \"rails/rails\"\r\n  gem \"sqlite3\"\r\nend\r\n\r\nrequire \"active_record\"\r\nrequire \"minitest/autorun\"\r\nrequire \"logger\"\r\n\r\n# This connection will do for database-independent bug reports.\r\nActiveRecord::Base.establish_connection(adapter: \"sqlite3\", database: \":memory:\")\r\nActiveRecord::Base.logger = Logger.new(STDOUT)\r\n\r\nActiveRecord::Schema.define do\r\n  create_table :posts, force: true do |t|\r\n    t.integer :comments_count\r\n  end\r\n\r\n  create_table :comments, force: true do |t|\r\n    t.integer :post_id\r\n  end\r\nend\r\n\r\nclass Post < ActiveRecord::Base\r\n  has_many :comments\r\nend\r\n\r\nclass Comment < ActiveRecord::Base\r\n  belongs_to :post, counter_cache: true\r\nend\r\n\r\nclass BugTest < Minitest::Test\r\n  def test_association_stuff\r\n    20.times { Post.create!(comments_count: rand(1..2000)) }\r\n\r\n    expected_average = Post.last(5).map(&:comments_count).sum / 5\r\n    expected_minimum = Post.last(5).map(&:comments_count).min\r\n\r\n    assert_equal expected_average, Post.order(id: :desc).limit(5).average(:comments_count).to_i\r\n    assert_equal expected_minimum, Post.order(id: :desc).limit(5).minimum(:comments_count).to_i\r\n  end\r\nend\r\n\r\n```\r\n### Expected behavior\r\n<!-- Tell us what should happen -->\r\nExpect ActiveRecord to honor the order clause when calculating aggregates\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead -->\r\nIt does not respect the order clause when calculating aggregates\r\n\r\n### System configuration\r\n**Rails version**:\r\nEdge\r\n**Ruby version**:\r\n2.6.6\r\n\r\nNote: Similar issue https://github.com/rails/rails/issues/39857, with open PR https://github.com/rails/rails/pull/39790 that does not resolve.",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39899",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39899/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39899/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39899/events",
    "html_url": "https://github.com/rails/rails/pull/39899",
    "id": 663311324,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU0NzQ4NjU2",
    "number": 39899,
    "title": "Save allocations in build middleware",
    "user": {
      "login": "vinistock",
      "id": 18742907,
      "node_id": "MDQ6VXNlcjE4NzQyOTA3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/18742907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vinistock",
      "html_url": "https://github.com/vinistock",
      "followers_url": "https://api.github.com/users/vinistock/followers",
      "following_url": "https://api.github.com/users/vinistock/following{/other_user}",
      "gists_url": "https://api.github.com/users/vinistock/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vinistock/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vinistock/subscriptions",
      "organizations_url": "https://api.github.com/users/vinistock/orgs",
      "repos_url": "https://api.github.com/users/vinistock/repos",
      "events_url": "https://api.github.com/users/vinistock/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vinistock/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107189,
        "node_id": "MDU6TGFiZWwxMDcxODk=",
        "url": "https://api.github.com/repos/rails/rails/labels/actionpack",
        "name": "actionpack",
        "color": "FFF700",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-21T21:11:18Z",
    "updated_at": "2020-07-21T21:11:21Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39899",
      "html_url": "https://github.com/rails/rails/pull/39899",
      "diff_url": "https://github.com/rails/rails/pull/39899.diff",
      "patch_url": "https://github.com/rails/rails/pull/39899.patch"
    },
    "body": "### Summary\r\n\r\nThis PR just uses `map!` instead of `map` for building the `only` and `except` options of middlewares to save a few allocations. It is slightly faster, although the deviation is quite high for this benchmark.\r\n\r\nAlso moved defaults into an else branch of the conditionals.\r\n\r\n### Benchmark\r\n```ruby\r\n# frozen_string_literal: true\r\n\r\nrequire \"bundler/inline\"\r\n\r\ngemfile(true) do\r\n  source \"https://rubygems.org\"\r\n\r\n  git_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\n  gem \"rails\", github: \"rails/rails\", require: \"rails/all\"\r\n  gem \"benchmark-ips\"\r\n  gem \"benchmark-memory\", require: \"benchmark/memory\"\r\nend\r\n\r\nmodule ActionController\r\n  class MiddlewareStack < ActionDispatch::MiddlewareStack\r\n    def fast_build_middleware(klass, args, block)\r\n      options = args.extract_options!\r\n      only   = Array(options.delete(:only)).map!(&:to_s)\r\n      except = Array(options.delete(:except)).map!(&:to_s)\r\n      args << options unless options.empty?\r\n\r\n      if only.any?\r\n        strategy = INCLUDE\r\n        list     = only\r\n      elsif except.any?\r\n        strategy = EXCLUDE\r\n        list     = except\r\n      else\r\n        strategy = NULL\r\n        list     = nil\r\n      end\r\n\r\n      Middleware.new(klass, args, list, strategy, block)\r\n    end\r\n  end\r\n\r\n  class Metal\r\n    class << self\r\n      def fast_use(*args, &block)\r\n        middleware_stack.fast_use(*args, &block)\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nmodule ActionDispatch\r\n  class MiddlewareStack\r\n    def fast_use(klass, *args, &block)\r\n      middlewares.push(fast_build_middleware(klass, args, block))\r\n    end\r\n  end\r\nend\r\n\r\nclass SomeMiddleware\r\n  def initialize(app)\r\n    @app = app\r\n  end\r\n\r\n  def call(env)\r\n    @app.call(env)\r\n  end\r\nend\r\n\r\nclass PostsController < ActionController::Base; end\r\n\r\nBenchmark.ips do |x|\r\n  x.report(\"use\")      { PostsController.use(SomeMiddleware, only: :index) }\r\n  x.report(\"fast_use\") { PostsController.fast_use(SomeMiddleware, only: :index) }\r\n  x.compare!\r\nend\r\n\r\nBenchmark.memory do |x|\r\n  x.report(\"use\")      { PostsController.use(SomeMiddleware, only: :index) }\r\n  x.report(\"fast_use\") { PostsController.fast_use(SomeMiddleware, only: :index) }\r\n  x.compare!\r\nend\r\n```\r\n\r\n### Results\r\n```\r\nWarming up --------------------------------------\r\n                 use    46.468k i/100ms\r\n            fast_use    44.369k i/100ms\r\nCalculating -------------------------------------\r\n                 use    359.433k (±47.1%) i/s -      1.301M in   5.146410s\r\n            fast_use    481.782k (±36.9%) i/s -      1.642M in   5.039612s\r\n\r\nComparison:\r\n            fast_use:   481782.3 i/s\r\n                 use:   359432.6 i/s - same-ish: difference falls within error\r\n\r\nCalculating -------------------------------------\r\n                 use   696.000  memsize (   200.000  retained)\r\n                        10.000  objects (     4.000  retained)\r\n                         1.000  strings (     1.000  retained)\r\n            fast_use   448.000  memsize (   200.000  retained)\r\n                         7.000  objects (     4.000  retained)\r\n                         1.000  strings (     1.000  retained)\r\n\r\nComparison:\r\n            fast_use:        448 allocated\r\n                 use:        696 allocated - 1.55x more\r\n```",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39898",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39898/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39898/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39898/events",
    "html_url": "https://github.com/rails/rails/issues/39898",
    "id": 663222563,
    "node_id": "MDU6SXNzdWU2NjMyMjI1NjM=",
    "number": 39898,
    "title": "ActiveRecord saved_changes returning nil for children updated through parent via nested attributes",
    "user": {
      "login": "shanexavier313",
      "id": 26637346,
      "node_id": "MDQ6VXNlcjI2NjM3MzQ2",
      "avatar_url": "https://avatars0.githubusercontent.com/u/26637346?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shanexavier313",
      "html_url": "https://github.com/shanexavier313",
      "followers_url": "https://api.github.com/users/shanexavier313/followers",
      "following_url": "https://api.github.com/users/shanexavier313/following{/other_user}",
      "gists_url": "https://api.github.com/users/shanexavier313/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shanexavier313/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shanexavier313/subscriptions",
      "organizations_url": "https://api.github.com/users/shanexavier313/orgs",
      "repos_url": "https://api.github.com/users/shanexavier313/repos",
      "events_url": "https://api.github.com/users/shanexavier313/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shanexavier313/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-21T18:31:16Z",
    "updated_at": "2020-07-23T02:39:26Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n```\r\n# frozen_string_literal: true\r\n\r\nrequire \"bundler/inline\"\r\n\r\ngemfile(true) do\r\n  source \"https://rubygems.org\"\r\n\r\n  git_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\n  gem \"rails\", github: \"rails/rails\"\r\n  gem \"sqlite3\"\r\n  gem \"pry\"\r\nend\r\n\r\nrequire \"active_record\"\r\nrequire \"minitest/autorun\"\r\nrequire \"logger\"\r\n\r\n# This connection will do for database-independent bug reports.\r\nActiveRecord::Base.establish_connection(adapter: \"sqlite3\", database: \":memory:\")\r\nActiveRecord::Base.logger = Logger.new(STDOUT)\r\n\r\nActiveRecord::Schema.define do\r\n  create_table :posts, force: true do |t|\r\n    t.string :name\r\n  end\r\n\r\n  create_table :comments, force: true do |t|\r\n    t.belongs_to :post\r\n    t.text :text\r\n  end\r\nend\r\n\r\nclass Post < ActiveRecord::Base\r\n  has_many :comments\r\n  accepts_nested_attributes_for :comments, allow_destroy: true\r\n\r\n  # not used in this test, just an example of the workaround method I used\r\n  def cache_comments\r\n    self.send(:comments)\r\n  end\r\nend\r\n\r\nclass Comment < ActiveRecord::Base\r\n  belongs_to :post\r\nend\r\n\r\nclass BugTest < Minitest::Test\r\n  def test_bad_child_saved_changes\r\n    post = Post.create!(name: 'Foo', comments_attributes: [{ text: 'foo' }])\r\n\r\n    post.update!(name: 'Bar', comments_attributes: [{ id: 1, text: 'bar' }])\r\n\r\n    post_changes = { \"name\"=>['Foo', 'Bar'] }\r\n    comment_changes = { \"text\"=>['foo', 'bar'] }\r\n\r\n    assert_equal post_changes, post.saved_changes\r\n    assert_equal comment_changes, post.comments.first.saved_changes\r\n  end\r\nend\r\n```\r\n### Expected behavior\r\nIdeally, `saved_changes` works for both the parent and child records after being updated via nested attributes.\r\n\r\n### Actual behavior\r\n`parent.saved_changes` works but calling `parent.child.saved_changes` does not. I believe it's because calling `parent.child` loads the child object from the database, which clears the `saved_changes` cache in accordance with the Active Record Dirty lifecycle (reloading from the database clears the cache). \r\n\r\n### Workaround + Other Thoughts\r\nI was able to get around this behavior in my app by defining a `cache_children` model method (similar to `cache_comments` in the Post model above), which I could call in a controller action. \r\n```\r\nclass Parent < ActiveRecord::Base\r\n  def cache_children\r\n    self.send(:children)\r\n  end\r\n```\r\nCalling that method cached the children on the parent object so that calling `parent.children.first.saved_changes` never hits the database and the children's `saved_changes` hash is preserved.\r\n\r\nMy thinking is that when updating a child via nested attributes through a parent, Active Record could cache the child that were updated onto the parent object so that calling `parent.child.saved_changes` never hits the database. Happy to take a crack at it if the team agrees with the approach.\r\n\r\n### System configuration\r\n**Rails version**: latest\r\n\r\n**Ruby version**: `2.6.4`",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39896",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39896/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39896/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39896/events",
    "html_url": "https://github.com/rails/rails/issues/39896",
    "id": 663187968,
    "node_id": "MDU6SXNzdWU2NjMxODc5Njg=",
    "number": 39896,
    "title": "Rails 6.0.3.2 : has_many with order scope => Triggers unwanted validation/error",
    "user": {
      "login": "john-999",
      "id": 3640027,
      "node_id": "MDQ6VXNlcjM2NDAwMjc=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3640027?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/john-999",
      "html_url": "https://github.com/john-999",
      "followers_url": "https://api.github.com/users/john-999/followers",
      "following_url": "https://api.github.com/users/john-999/following{/other_user}",
      "gists_url": "https://api.github.com/users/john-999/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/john-999/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/john-999/subscriptions",
      "organizations_url": "https://api.github.com/users/john-999/orgs",
      "repos_url": "https://api.github.com/users/john-999/repos",
      "events_url": "https://api.github.com/users/john-999/events{/privacy}",
      "received_events_url": "https://api.github.com/users/john-999/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-21T17:32:46Z",
    "updated_at": "2020-07-21T18:09:00Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n    class Book < ApplicationRecord\r\n      has_many :pages, -> { order(\"page_number\") }, dependent: :destroy\r\n      accepts_nested_attributes_for :pages, allow_destroy: true\r\n    end\r\n\r\nSubmit (create) a new Book via a book form containing one or more nested Page forms.\r\n\r\n### Expected behavior\r\nNo validation should be triggered, thus no error message should appear.\r\n\r\n### Actual behavior\r\nUpon form submission, the validation error ```Pages book is required``` appears.\r\nIf I remove the order scope ```-> { order(\"page_number\") }```, then the error does not appear, thus the validation seems not to be triggered.\r\n\r\n### System configuration\r\n**Rails version**: Rails 6.0.3.2\r\n\r\n**Ruby version**: ruby 2.7.0p0\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39894",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39894/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39894/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39894/events",
    "html_url": "https://github.com/rails/rails/issues/39894",
    "id": 662791827,
    "node_id": "MDU6SXNzdWU2NjI3OTE4Mjc=",
    "number": 39894,
    "title": "ActiveRecord sql structure file dump fails",
    "user": {
      "login": "mattbaumann",
      "id": 10552314,
      "node_id": "MDQ6VXNlcjEwNTUyMzE0",
      "avatar_url": "https://avatars1.githubusercontent.com/u/10552314?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattbaumann",
      "html_url": "https://github.com/mattbaumann",
      "followers_url": "https://api.github.com/users/mattbaumann/followers",
      "following_url": "https://api.github.com/users/mattbaumann/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattbaumann/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattbaumann/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattbaumann/subscriptions",
      "organizations_url": "https://api.github.com/users/mattbaumann/orgs",
      "repos_url": "https://api.github.com/users/mattbaumann/repos",
      "events_url": "https://api.github.com/users/mattbaumann/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattbaumann/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-21T09:21:47Z",
    "updated_at": "2020-07-24T14:46:11Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n\r\n1. Postgres 12.3 client and db server in docker and `DATABASE_URL=postgresql://postgres:postgres@postgres:5432`\r\n2. `schema_format` set  to `:sql`\r\n3. invoke ` $ ./bin/rails db:migrate --trace RAILS_ENV=test`\r\n\r\nThe db:structure:dump works fine with `schema_format` set  to `:ruby`.\r\n\r\nIt it my gut feeling, that `pg_dump` does not behave correctly on my system, but I'd wish to have a better error msg to determine that.\r\n\r\n*Dockerfile of Runtime Container*\r\n\r\n```\r\nFROM ruby:2.7-alpine3.12\r\n\r\nRUN apk --update add postgresql-client postgresql-dev ca-certificates imagemagick chromium firefox-esr build-base python2 tzdata libc6-compat && gem install bundler\r\n\r\n# Install NodeJS fast\r\n\r\nENV NODE_VERSION 14.5.0\r\n\r\n# Install NodeJS like the NodeJS Container's Dockerfile\r\n\r\n```\r\n\r\n*Gemfile*\r\n\r\n```\r\nsource 'https://rubygems.org'\r\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\nruby '2.7.1'\r\n\r\n# Documentation\r\ngem 'sdoc', '~> 1.1.0'\r\n\r\ngem 'active_storage_validations', '~> 0.8.9'\r\ngem 'font-awesome-sass', '~> 5.13.0'\r\ngem 'mini_magick', '>= 4.9.5'\r\ngem 'parslet', '~> 2.0.0'\r\ngem 'pg_search', '~> 2.2.0'\r\ngem 'ruby-units', '~> 2.3.1'\r\ngem 'will_paginate', '~> 3.3.0'\r\n\r\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\r\ngem 'postgresql', '~> 1.0.0'\r\ngem 'rails', '~> 6.0.3', '>= 6.0.3.2'\r\n# Use Puma as the app server\r\ngem 'puma', '~> 4.1'\r\ngem 'rack-contrib', '~> 2.2.0'\r\n# Use SCSS for stylesheets\r\ngem 'sass-rails', '>= 6'\r\n# Transpile app-like JavaScript. Read more: https://github.com/rails/webpacker\r\ngem 'webpacker', '~> 4.0'\r\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\r\ngem 'turbolinks', '~> 5'\r\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\r\ngem 'jbuilder', '~> 2.7'\r\n# Use Redis adapter to run Action Cable in production\r\n# gem 'redis', '~> 4.0'\r\n# Use Active Model has_secure_password\r\n# gem 'bcrypt', '~> 3.1.7'\r\n\r\n# Use Active Storage variant\r\n# gem 'image_processing', '~> 1.2'\r\n\r\n# Style Sheets\r\ngem 'bulma-rails', '~> 0.8.0'\r\n\r\n# Reduces boot times through caching; required in config/boot.rb\r\ngem 'bootsnap', '>= 1.4.2', require: false\r\n\r\ngroup :development, :test do\r\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\r\n  gem 'byebug', platforms: %i[mri mingw x64_mingw]\r\n  gem 'rspec-rails', '~> 4.0.1'\r\n  gem 'rubocop', '~> 0.88.0', require: false\r\nend\r\n\r\ngroup :development do\r\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\r\n  gem 'listen', '>= 3.0.5', '< 3.2'\r\n  gem 'web-console', '>= 3.3.0'\r\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\r\n  gem 'spring'\r\n  gem 'spring-watcher-listen', '~> 2.0.0'\r\nend\r\n\r\ngroup :test do\r\n  # Adds support for Capybara system testing and selenium driver\r\n  gem 'capybara', '>= 2.15'\r\n  gem 'selenium-webdriver'\r\n  # Easy installation and use of web drivers to run system tests with browsers\r\n  gem 'apparition'\r\n  gem 'factory_bot_rails', '~> 6.0.0'\r\n  gem 'launchy', '~> 2.5.0'\r\n  gem 'rails-controller-testing', '~> 1.0.4'\r\n  gem 'rspec_junit_formatter', '~> 0.4.1'\r\n  gem 'shoulda-matchers', '~> 4.3.0'\r\n  gem 'webdrivers'\r\nend\r\n\r\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\r\ngem 'tzinfo-data', platforms: %i[mingw mswin x64_mingw jruby]\r\n\r\n```\r\n\r\n\r\n\r\n### Expected behavior\r\n\r\nDump structure.sql file to /db and exit with 0.\r\n\r\n### Actual behavior\r\n\r\n```\r\n== 20200628145801 ChangeUnitValueName: migrated (0.0039s) =====================\r\n ** Invoke db:_dump (first_time)\r\n ** Execute db:_dump\r\n ** Invoke db:structure:dump (first_time)\r\n ** Invoke db:load_config \r\n ** Execute db:structure:dump\r\n rails aborted!\r\n TypeError: no implicit conversion of nil into String\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/tasks/postgresql_database_tasks.rb:113:in `system'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/tasks/postgresql_database_tasks.rb:113:in `run_cmd'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/tasks/postgresql_database_tasks.rb:78:in `structure_dump'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/tasks/database_tasks.rb:310:in `structure_dump'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/tasks/database_tasks.rb:380:in `dump_schema'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/railties/databases.rake:435:in `block (4 levels) in <main>'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/railties/databases.rake:433:in `each'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/railties/databases.rake:433:in `block (3 levels) in <main>'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `block in execute'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `each'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `execute'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:219:in `block in invoke_with_call_chain'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:199:in `synchronize'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:199:in `invoke_with_call_chain'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:188:in `invoke'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/railties/databases.rake:98:in `block (2 levels) in <main>'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `block in execute'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `each'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `execute'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:219:in `block in invoke_with_call_chain'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:199:in `synchronize'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:199:in `invoke_with_call_chain'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:188:in `invoke'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activerecord-6.0.3.2/lib/active_record/railties/databases.rake:88:in `block (2 levels) in <main>'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `block in execute'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `each'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:281:in `execute'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:219:in `block in invoke_with_call_chain'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:199:in `synchronize'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:199:in `invoke_with_call_chain'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/task.rb:188:in `invoke'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/application.rb:160:in `invoke_task'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/application.rb:116:in `block (2 levels) in top_level'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/application.rb:116:in `each'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/application.rb:116:in `block in top_level'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/application.rb:125:in `run_with_threads'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/application.rb:110:in `top_level'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/railties-6.0.3.2/lib/rails/commands/rake/rake_command.rb:23:in `block in perform'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/rake-13.0.1/lib/rake/application.rb:186:in `standard_exception_handling'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/railties-6.0.3.2/lib/rails/commands/rake/rake_command.rb:20:in `perform'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/railties-6.0.3.2/lib/rails/command.rb:48:in `invoke'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/railties-6.0.3.2/lib/rails/commands.rb:18:in `<main>'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/bootsnap-1.4.6/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:23:in `require'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/bootsnap-1.4.6/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:23:in `block in require_with_bootsnap_lfi'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/bootsnap-1.4.6/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/bootsnap-1.4.6/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require_with_bootsnap_lfi'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/bootsnap-1.4.6/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:31:in `require'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activesupport-6.0.3.2/lib/active_support/dependencies.rb:324:in `block in require'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activesupport-6.0.3.2/lib/active_support/dependencies.rb:291:in `load_dependency'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/activesupport-6.0.3.2/lib/active_support/dependencies.rb:324:in `require'\r\n /builds/infra/cook-book/bin/rails:9:in `<top (required)>'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/spring-2.1.0/lib/spring/client/rails.rb:28:in `load'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/spring-2.1.0/lib/spring/client/rails.rb:28:in `call'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/spring-2.1.0/lib/spring/client/command.rb:7:in `call'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/spring-2.1.0/lib/spring/client.rb:30:in `run'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/spring-2.1.0/bin/spring:49:in `<top (required)>'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/spring-2.1.0/lib/spring/binstub.rb:11:in `load'\r\n /builds/infra/cook-book/vendor/ruby/ruby/2.7.0/gems/spring-2.1.0/lib/spring/binstub.rb:11:in `<top (required)>'\r\n /usr/local/lib/ruby/2.7.0/rubygems/core_ext/kernel_require.rb:72:in `require'\r\n /usr/local/lib/ruby/2.7.0/rubygems/core_ext/kernel_require.rb:72:in `require'\r\n /builds/infra/cook-book/bin/spring:15:in `<top (required)>'\r\n ./bin/rails:3:in `load'\r\n ./bin/rails:3:in `<main>'\r\n Tasks: TOP => db:structure:dump\r\n```\r\n\r\n### System configuration\r\n**Rails version**:\r\n6.0.3\r\n**Ruby version**:\r\n2.7.1",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39893",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39893/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39893/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39893/events",
    "html_url": "https://github.com/rails/rails/issues/39893",
    "id": 662735979,
    "node_id": "MDU6SXNzdWU2NjI3MzU5Nzk=",
    "number": 39893,
    "title": "Making a where statement on an included association changes the associations on the resulting records",
    "user": {
      "login": "b-nik",
      "id": 32591851,
      "node_id": "MDQ6VXNlcjMyNTkxODUx",
      "avatar_url": "https://avatars0.githubusercontent.com/u/32591851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/b-nik",
      "html_url": "https://github.com/b-nik",
      "followers_url": "https://api.github.com/users/b-nik/followers",
      "following_url": "https://api.github.com/users/b-nik/following{/other_user}",
      "gists_url": "https://api.github.com/users/b-nik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/b-nik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/b-nik/subscriptions",
      "organizations_url": "https://api.github.com/users/b-nik/orgs",
      "repos_url": "https://api.github.com/users/b-nik/repos",
      "events_url": "https://api.github.com/users/b-nik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/b-nik/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-21T08:20:24Z",
    "updated_at": "2020-07-21T08:20:24Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n```ruby\r\n# frozen_string_literal: true\r\n\r\nrequire \"bundler/inline\"\r\n\r\ngemfile(true) do\r\n  source \"https://rubygems.org\"\r\n\r\n  git_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\n  gem \"rails\", github: \"rails/rails\"\r\n  gem \"sqlite3\"\r\nend\r\n\r\nrequire \"active_record\"\r\nrequire \"minitest/autorun\"\r\nrequire \"logger\"\r\n\r\n# This connection will do for database-independent bug reports.\r\nActiveRecord::Base.establish_connection(adapter: \"sqlite3\", database: \":memory:\")\r\nActiveRecord::Base.logger = Logger.new(STDOUT)\r\n\r\nActiveRecord::Schema.define do\r\n  create_table :tasks\r\n  create_table :users\r\n  create_join_table :tasks, :users\r\nend\r\n\r\nclass Task < ActiveRecord::Base\r\n  has_and_belongs_to_many :users\r\nend\r\n\r\nclass User < ActiveRecord::Base\r\n  has_and_belongs_to_many :tasks\r\nend\r\n\r\nclass BugTest < Minitest::Test\r\n  def test_association_stuff\r\n    task = Task.create!\r\n    3.times { task.users.create! }\r\n\r\n    a = Task.where(id: task.id).map(&:user_ids)\r\n    b = Task.where(id: task.id).includes(:users).where(users: { id: User.first.id }).map(&:user_ids)\r\n\r\n    assert_equal a, b\r\n  end\r\nend\r\n```\r\n\r\n### Expected behavior\r\nMaking a where statement shouldn't change the associations of the returned records from what they are in the database.\r\n\r\n### Actual behavior\r\nThe returned records have the queried associations changed. It seems like they are filtered by the where statement, but I think saying something like \"task.user_ids\" from the resulting object should return what is actually stored in the database.\r\n\r\n### System configuration\r\n**Rails version**: master, 6, 5\r\n\r\n**Ruby version**: 2.5.5\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39891",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39891/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39891/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39891/events",
    "html_url": "https://github.com/rails/rails/pull/39891",
    "id": 662485436,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDU0MDM2Mjc2",
    "number": 39891,
    "title": "touch parent model when an attachment is purged",
    "user": {
      "login": "victorperez",
      "id": 3148044,
      "node_id": "MDQ6VXNlcjMxNDgwNDQ=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3148044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/victorperez",
      "html_url": "https://github.com/victorperez",
      "followers_url": "https://api.github.com/users/victorperez/followers",
      "following_url": "https://api.github.com/users/victorperez/following{/other_user}",
      "gists_url": "https://api.github.com/users/victorperez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/victorperez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/victorperez/subscriptions",
      "organizations_url": "https://api.github.com/users/victorperez/orgs",
      "repos_url": "https://api.github.com/users/victorperez/repos",
      "events_url": "https://api.github.com/users/victorperez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/victorperez/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 664533972,
        "node_id": "MDU6TGFiZWw2NjQ1MzM5NzI=",
        "url": "https://api.github.com/repos/rails/rails/labels/activestorage",
        "name": "activestorage",
        "color": "bfd4f2",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-21T02:19:17Z",
    "updated_at": "2020-07-21T02:19:20Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39891",
      "html_url": "https://github.com/rails/rails/pull/39891",
      "diff_url": "https://github.com/rails/rails/pull/39891.diff",
      "patch_url": "https://github.com/rails/rails/pull/39891.patch"
    },
    "body": "### Summary\r\n\r\nCurrently `delete` is used on the `purge` and `purge_later` methods, that prevent any callbacks to be triggered which causes the parent model to not be updated when an attachment is purged. This behaviour cause issues on some caching strategies as reported here: https://github.com/rails/rails/issues/39858\r\n\r\nChanges:\r\n\r\n* Add `record&.touch` on `attachment#purge`\r\n* Add `record&.touch` on `attachment#purge_later`\r\n* Remove extra blank line on `attachment.rb`\r\n* Add tests which are failing before this change and pass after the change\r\n\r\n### Other Information\r\n\r\n`delete` has not been changed to `destroy` to avoid to trigger the `after_destroy_commit :purge_dependent_blob_later`\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39890",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39890/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39890/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39890/events",
    "html_url": "https://github.com/rails/rails/pull/39890",
    "id": 662372628,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDUzOTM1ODk0",
    "number": 39890,
    "title": "Add &block to link_to call in link_to_if helper",
    "user": {
      "login": "tgrushka",
      "id": 40548478,
      "node_id": "MDQ6VXNlcjQwNTQ4NDc4",
      "avatar_url": "https://avatars0.githubusercontent.com/u/40548478?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tgrushka",
      "html_url": "https://github.com/tgrushka",
      "followers_url": "https://api.github.com/users/tgrushka/followers",
      "following_url": "https://api.github.com/users/tgrushka/following{/other_user}",
      "gists_url": "https://api.github.com/users/tgrushka/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tgrushka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tgrushka/subscriptions",
      "organizations_url": "https://api.github.com/users/tgrushka/orgs",
      "repos_url": "https://api.github.com/users/tgrushka/repos",
      "events_url": "https://api.github.com/users/tgrushka/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tgrushka/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 3666649,
        "node_id": "MDU6TGFiZWwzNjY2NjQ5",
        "url": "https://api.github.com/repos/rails/rails/labels/actionview",
        "name": "actionview",
        "color": "d7e102",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-20T23:27:58Z",
    "updated_at": "2020-07-20T23:28:01Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39890",
      "html_url": "https://github.com/rails/rails/pull/39890",
      "diff_url": "https://github.com/rails/rails/pull/39890.diff",
      "patch_url": "https://github.com/rails/rails/pull/39890.patch"
    },
    "body": "link_to_if:\r\nThe &block argument is missing from the link_to call when condition evaluates to true, resulting in unexpected behavior when passing a block to link_to_if or link_to_unless, as documented here:\r\nhttps://apidock.com/rails/ActionView/Helpers/UrlHelper/link_to_if#1589-Passing-a-block-does-not-behave-as-expected\r\n\r\n### Summary\r\n\r\nAdding the &block argument should result in link_to_if with block having the expected behavior.\r\n\r\n<!-- Provide a general description of the code changes in your pull\r\nrequest... were there any bugs you had fixed? If so, mention them. If\r\nthese bugs have open GitHub issues, be sure to tag them here as well,\r\nto keep the conversation linked together. -->\r\n\r\n### Other Information\r\n\r\n<!-- If there's anything else that's important and relevant to your pull\r\nrequest, mention that information here. This could include\r\nbenchmarks, or other information.\r\n\r\nIf you are updating any of the CHANGELOG files or are asked to update the\r\nCHANGELOG files by reviewers, please add the CHANGELOG entry at the top of the file.\r\n\r\nFinally, if your pull request affects documentation or any non-code\r\nchanges, guidelines for those changes are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation)\r\n\r\nThanks for contributing to Rails! -->\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39886",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39886/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39886/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39886/events",
    "html_url": "https://github.com/rails/rails/pull/39886",
    "id": 661689266,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDUzMzMyMTgz",
    "number": 39886,
    "title": " [ci skip] Append some description about advance constraints",
    "user": {
      "login": "lanzhiheng",
      "id": 8858472,
      "node_id": "MDQ6VXNlcjg4NTg0NzI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/8858472?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lanzhiheng",
      "html_url": "https://github.com/lanzhiheng",
      "followers_url": "https://api.github.com/users/lanzhiheng/followers",
      "following_url": "https://api.github.com/users/lanzhiheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lanzhiheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lanzhiheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lanzhiheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lanzhiheng/orgs",
      "repos_url": "https://api.github.com/users/lanzhiheng/repos",
      "events_url": "https://api.github.com/users/lanzhiheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lanzhiheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 150377,
        "node_id": "MDU6TGFiZWwxNTAzNzc=",
        "url": "https://api.github.com/repos/rails/rails/labels/docs",
        "name": "docs",
        "color": "02d7e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-20T11:06:00Z",
    "updated_at": "2020-07-21T16:37:53Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39886",
      "html_url": "https://github.com/rails/rails/pull/39886",
      "diff_url": "https://github.com/rails/rails/pull/39886.diff",
      "patch_url": "https://github.com/rails/rails/pull/39886.patch"
    },
    "body": "### Summary\r\n\r\nSimple changes of the document for better describing the usage of routes's constraints.  \r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39885",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39885/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39885/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39885/events",
    "html_url": "https://github.com/rails/rails/pull/39885",
    "id": 661561894,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDUzMjIwMDcw",
    "number": 39885,
    "title": "fix: duplicated load /bin/spring",
    "user": {
      "login": "lolychee",
      "id": 610480,
      "node_id": "MDQ6VXNlcjYxMDQ4MA==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/610480?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lolychee",
      "html_url": "https://github.com/lolychee",
      "followers_url": "https://api.github.com/users/lolychee/followers",
      "following_url": "https://api.github.com/users/lolychee/following{/other_user}",
      "gists_url": "https://api.github.com/users/lolychee/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lolychee/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lolychee/subscriptions",
      "organizations_url": "https://api.github.com/users/lolychee/orgs",
      "repos_url": "https://api.github.com/users/lolychee/repos",
      "events_url": "https://api.github.com/users/lolychee/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lolychee/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107195,
        "node_id": "MDU6TGFiZWwxMDcxOTU=",
        "url": "https://api.github.com/repos/rails/rails/labels/railties",
        "name": "railties",
        "color": "8BE06E",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 2,
    "created_at": "2020-07-20T09:00:12Z",
    "updated_at": "2020-07-21T06:50:59Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39885",
      "html_url": "https://github.com/rails/rails/pull/39885",
      "diff_url": "https://github.com/rails/rails/pull/39885.diff",
      "patch_url": "https://github.com/rails/rails/pull/39885.patch"
    },
    "body": "### Summary\r\n\r\n<!-- Provide a general description of the code changes in your pull\r\nrequest... were there any bugs you had fixed? If so, mention them. If\r\nthese bugs have open GitHub issues, be sure to tag them here as well,\r\nto keep the conversation linked together. -->\r\n\r\nwhen I use `rails s`, it raise an error:\r\n```\r\nYou've tried to invoke Spring when it's already loaded (i.e. the Spring constant is defined).\r\n\r\nThis is probably because you generated binstubs with Spring 1.0, and you now have a Spring version > 1.0 on your system. To solve this, upgrade your bundle to the latest Spring version and then run `bundle exec spring binstub --all` to regenerate your binstubs. This is a one-time step necessary to upgrade from 1.0 to 1.1.\r\n\r\nHere's the backtrace:\r\n\r\n/usr/local/bundle/gems/spring-2.1.0/lib/spring/binstub.rb:11:in `load'\r\n/usr/local/bundle/gems/spring-2.1.0/lib/spring/binstub.rb:11:in `<top (required)>'\r\n/usr/local/lib/ruby/2.7.0/rubygems/core_ext/kernel_require.rb:92:in `require'\r\n/usr/local/lib/ruby/2.7.0/rubygems/core_ext/kernel_require.rb:92:in `require'\r\n/workspace/bin/spring:15:in `<top (required)>'\r\n/workspace/config/boot.rb:2:in `load'\r\n/workspace/config/boot.rb:2:in `<top (required)>'\r\n./bin/rails:2:in `require_relative'\r\n./bin/rails:2:in `<main>'\r\n```\r\n\r\n### Other Information\r\n\r\n<!-- If there's anything else that's important and relevant to your pull\r\nrequest, mention that information here. This could include\r\nbenchmarks, or other information.\r\n\r\nIf you are updating any of the CHANGELOG files or are asked to update the\r\nCHANGELOG files by reviewers, please add the CHANGELOG entry at the top of the file.\r\n\r\nFinally, if your pull request affects documentation or any non-code\r\nchanges, guidelines for those changes are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation)\r\n\r\nThanks for contributing to Rails! -->\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39880",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39880/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39880/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39880/events",
    "html_url": "https://github.com/rails/rails/pull/39880",
    "id": 660875198,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDUyNTk4NzI4",
    "number": 39880,
    "title": "Fix instrumenting internal server errors",
    "user": {
      "login": "hennevogel",
      "id": 514785,
      "node_id": "MDQ6VXNlcjUxNDc4NQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/514785?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hennevogel",
      "html_url": "https://github.com/hennevogel",
      "followers_url": "https://api.github.com/users/hennevogel/followers",
      "following_url": "https://api.github.com/users/hennevogel/following{/other_user}",
      "gists_url": "https://api.github.com/users/hennevogel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hennevogel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hennevogel/subscriptions",
      "organizations_url": "https://api.github.com/users/hennevogel/orgs",
      "repos_url": "https://api.github.com/users/hennevogel/repos",
      "events_url": "https://api.github.com/users/hennevogel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hennevogel/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107189,
        "node_id": "MDU6TGFiZWwxMDcxODk=",
        "url": "https://api.github.com/repos/rails/rails/labels/actionpack",
        "name": "actionpack",
        "color": "FFF700",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-19T14:42:06Z",
    "updated_at": "2020-07-19T14:42:09Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39880",
      "html_url": "https://github.com/rails/rails/pull/39880",
      "diff_url": "https://github.com/rails/rails/pull/39880.diff",
      "patch_url": "https://github.com/rails/rails/pull/39880.patch"
    },
    "body": "### Summary\r\n\r\nIn case of an exception we never reach setting the status in the payload so it is unset afterward.\r\n\r\nLet's catch the exception and set status based on the exception class name. Then re-raise it.\r\n\r\n### Other Information\r\n\r\nThis is basically the equivalent of what happens in\r\n\r\nActionController::LogSubscriber.process_action\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39879",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39879/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39879/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39879/events",
    "html_url": "https://github.com/rails/rails/issues/39879",
    "id": 660815494,
    "node_id": "MDU6SXNzdWU2NjA4MTU0OTQ=",
    "number": 39879,
    "title": "Js rendering bug",
    "user": {
      "login": "fastengineer",
      "id": 9559372,
      "node_id": "MDQ6VXNlcjk1NTkzNzI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9559372?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fastengineer",
      "html_url": "https://github.com/fastengineer",
      "followers_url": "https://api.github.com/users/fastengineer/followers",
      "following_url": "https://api.github.com/users/fastengineer/following{/other_user}",
      "gists_url": "https://api.github.com/users/fastengineer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fastengineer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fastengineer/subscriptions",
      "organizations_url": "https://api.github.com/users/fastengineer/orgs",
      "repos_url": "https://api.github.com/users/fastengineer/repos",
      "events_url": "https://api.github.com/users/fastengineer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fastengineer/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 1071962662,
        "node_id": "MDU6TGFiZWwxMDcxOTYyNjYy",
        "url": "https://api.github.com/repos/rails/rails/labels/more-information-needed",
        "name": "more-information-needed",
        "color": "bfdadc",
        "default": false,
        "description": "When reporter needs to provide more information"
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-19T12:43:44Z",
    "updated_at": "2020-07-21T00:54:00Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "Latest ruby and latest rails.\r\n\r\nA simple rendering with remote: true option on view doesn't works like expected.\r\nIt is rendering json.\r\n\r\nExpected:\r\nController fetches photos to @photos variable\r\nA publicindex.html.haml renders collection of _photos.html.haml partial\r\n_photos.html.haml renders collection of _tag.html.haml\r\n\r\nResult.\r\n```\r\nStarted GET \"/ansail?page=2\" for ::1 at 2020-07-19 15:34:38 +0300\r\nProcessing by PhotosController#publicindex as JS\r\n  Parameters: {\"page\"=>\"2\", \"instagram_name\"=>\"ansail\"}\r\n  Rendering photos/publicindex.js.erb\r\n  Rendered collection of photos/_photo.json.jbuilder [16 times] (Duration: 24.4ms | Allocations: 10042)\r\n  Rendered photos/_photos.html.haml (Duration: 28.7ms | Allocations: 11244)\r\n  Rendered photos/publicindex.js.erb (Duration: 29.5ms | Allocations: 11991)\r\nCompleted 200 OK in 43ms (Views: 28.6ms | ActiveRecord: 5.2ms | Allocations: 17208)\r\n```\r\n\r\nIf I delete my _photo.json.jbuilder file it renders photos but renders tags as json instead of js.\r\n_photos.html.haml file below\r\n`= render @photos || \"There are no photos available.\"`",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39876",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39876/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39876/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39876/events",
    "html_url": "https://github.com/rails/rails/issues/39876",
    "id": 660476841,
    "node_id": "MDU6SXNzdWU2NjA0NzY4NDE=",
    "number": 39876,
    "title": "error 429 - too many request  on Video Streaming",
    "user": {
      "login": "nsikanikpoh",
      "id": 28611761,
      "node_id": "MDQ6VXNlcjI4NjExNzYx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/28611761?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nsikanikpoh",
      "html_url": "https://github.com/nsikanikpoh",
      "followers_url": "https://api.github.com/users/nsikanikpoh/followers",
      "following_url": "https://api.github.com/users/nsikanikpoh/following{/other_user}",
      "gists_url": "https://api.github.com/users/nsikanikpoh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nsikanikpoh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nsikanikpoh/subscriptions",
      "organizations_url": "https://api.github.com/users/nsikanikpoh/orgs",
      "repos_url": "https://api.github.com/users/nsikanikpoh/repos",
      "events_url": "https://api.github.com/users/nsikanikpoh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nsikanikpoh/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-19T00:34:24Z",
    "updated_at": "2020-07-21T03:17:02Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce\r\n<!-- (Guidelines for creating a bug report are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#creating-a-bug-report)) -->\r\n\r\n### Expected behavior\r\n<!-- Tell us what should happen -->\r\n\r\n### Actual behavior\r\n<!-- Tell us what happens instead -->\r\nproduces error 429 - too many request  on Video Streaming. from api \r\n### System configuration\r\n**Rails version**:\r\n5.2.3\r\n**Ruby version**:\r\n2.6\r\n",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39874",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39874/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39874/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39874/events",
    "html_url": "https://github.com/rails/rails/pull/39874",
    "id": 660208823,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxOTg1Mjcz",
    "number": 39874,
    "title": "Add support for aliasing selected fields.",
    "user": {
      "login": "simi",
      "id": 193936,
      "node_id": "MDQ6VXNlcjE5MzkzNg==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/193936?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simi",
      "html_url": "https://github.com/simi",
      "followers_url": "https://api.github.com/users/simi/followers",
      "following_url": "https://api.github.com/users/simi/following{/other_user}",
      "gists_url": "https://api.github.com/users/simi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simi/subscriptions",
      "organizations_url": "https://api.github.com/users/simi/orgs",
      "repos_url": "https://api.github.com/users/simi/repos",
      "events_url": "https://api.github.com/users/simi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simi/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107191,
        "node_id": "MDU6TGFiZWwxMDcxOTE=",
        "url": "https://api.github.com/repos/rails/rails/labels/activerecord",
        "name": "activerecord",
        "color": "0b02e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-18T15:22:34Z",
    "updated_at": "2020-07-18T15:28:40Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39874",
      "html_url": "https://github.com/rails/rails/pull/39874",
      "diff_url": "https://github.com/rails/rails/pull/39874.diff",
      "patch_url": "https://github.com/rails/rails/pull/39874.patch"
    },
    "body": "### Summary\r\n\r\nOften I would like to include some calculation for grouped value within SELECT statement. I need to reselect default selection and add sql fragment for aliasing aggregation function result.\r\n\r\n```ruby\r\nAccount.joins(:users).group(:id).select('accounts.*, count(users.id) AS user_count')\r\n#=> SELECT accounts.*, count(users.id) AS user_count FROM \"accounts\" INNER JOIN \"users\" ON \"users\".\"account_id\" = \"accounts\".\"id\" GROUP BY \"accounts\".\"id\" LIMIT $1\r\n```\r\n\r\nWith this patch I can get same query with following:\r\n\r\n```ruby\r\nAccount.joins(:users).group(:id).select('accounts.*', 'count(users.id)' => :user_count)\r\n#=> SELECT accounts.*, count(users.id) AS user_count FROM \"accounts\" INNER JOIN \"users\" ON \"users\".\"account_id\" = \"accounts\".\"id\" GROUP BY \"accounts\".\"id\" LIMIT $1\r\n```\r\n\r\nWhen combined with https://github.com/rails/rails/pull/39873, it is possible to use (IMHO) nicer approach:\r\n\r\n```ruby\r\nAccount.joins(:users).group(:id).select_append('count(users.id)' => :user_count)\r\n#=> SELECT accounts.*, count(users.id) AS user_count FROM \"accounts\" INNER JOIN \"users\" ON \"users\".\"account_id\" = \"accounts\".\"id\" GROUP BY \"accounts\".\"id\" LIMIT $1\r\n```\r\n\r\n### TODO\r\n- [ ] changelog entry\r\n- [ ] documentation",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39873",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39873/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39873/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39873/events",
    "html_url": "https://github.com/rails/rails/pull/39873",
    "id": 660163102,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxOTQzNzE0",
    "number": 39873,
    "title": "Add Relation#select_append method to append to default selection.",
    "user": {
      "login": "simi",
      "id": 193936,
      "node_id": "MDQ6VXNlcjE5MzkzNg==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/193936?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simi",
      "html_url": "https://github.com/simi",
      "followers_url": "https://api.github.com/users/simi/followers",
      "following_url": "https://api.github.com/users/simi/following{/other_user}",
      "gists_url": "https://api.github.com/users/simi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simi/subscriptions",
      "organizations_url": "https://api.github.com/users/simi/orgs",
      "repos_url": "https://api.github.com/users/simi/repos",
      "events_url": "https://api.github.com/users/simi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simi/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 107191,
        "node_id": "MDU6TGFiZWwxMDcxOTE=",
        "url": "https://api.github.com/repos/rails/rails/labels/activerecord",
        "name": "activerecord",
        "color": "0b02e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-07-18T13:51:58Z",
    "updated_at": "2020-07-18T14:10:48Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39873",
      "html_url": "https://github.com/rails/rails/pull/39873",
      "diff_url": "https://github.com/rails/rails/pull/39873.diff",
      "patch_url": "https://github.com/rails/rails/pull/39873.patch"
    },
    "body": "### How `select` works\r\n\r\n- when **no** `select` is used for query **all columns** are **selected**\r\n- when `select` is used only **selected columns** are **selected**\r\n\r\n### Why `select` is not enough?\r\n\r\nOften I would like to just append to current selection. Currently I need to check if anything was selected before or select `Arel.star` on my own. But I don't actually care what was selected before, I would like to add new field everytime.\r\n\r\n```ruby\r\n# before\r\nUser.joins(:account).select(User.arel_table[Arel.star], 'accounts.name AS account_name')\r\n#=> SELECT \"users\".*, accounts.name AS account_name FROM \"users\" INNER JOIN \"accounts\" ON \"accounts\".\"id\" = \"users\".\"account_id\" LIMIT $1 \r\n\r\n\r\n# after\r\nUser.joins(:account).select_append('accounts.name AS account_name')\r\n#=> SELECT \"users\".*, accounts.name AS account_name FROM \"users\" INNER JOIN \"accounts\" ON \"accounts\".\"id\" = \"users\".\"account_id\" LIMIT $1\r\n```\r\n\r\n### TODO\r\n\r\n- [ ] changelog entry\r\n- [ ] documentation\r\n\r\n---\r\n\r\n:information_source: We are using following monkey-patch in our app for some time already.\r\n\r\n```ruby\r\nmodule ActiveRecord\r\n  module SelectAppend\r\n    extend ActiveSupport::Concern\r\n\r\n    included do\r\n      ActiveRecord::Querying.delegate :select_append, to: :all\r\n    end\r\n\r\n    def select_append(*fields)\r\n      raise ArgumentError, \"Call `select_append' with at least one field\" if fields.empty?\r\n\r\n      self.select_values = [table[Arel.star]] unless self.select_values.present?\r\n      select(*fields)\r\n    end\r\n  end\r\nend\r\n```",
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rails/rails/issues/39871",
    "repository_url": "https://api.github.com/repos/rails/rails",
    "labels_url": "https://api.github.com/repos/rails/rails/issues/39871/labels{/name}",
    "comments_url": "https://api.github.com/repos/rails/rails/issues/39871/comments",
    "events_url": "https://api.github.com/repos/rails/rails/issues/39871/events",
    "html_url": "https://github.com/rails/rails/pull/39871",
    "id": 660051388,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxODQxMzE5",
    "number": 39871,
    "title": "Add copy button for copying guide code examples [skip ci]",
    "user": {
      "login": "p8",
      "id": 28561,
      "node_id": "MDQ6VXNlcjI4NTYx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/28561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/p8",
      "html_url": "https://github.com/p8",
      "followers_url": "https://api.github.com/users/p8/followers",
      "following_url": "https://api.github.com/users/p8/following{/other_user}",
      "gists_url": "https://api.github.com/users/p8/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/p8/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/p8/subscriptions",
      "organizations_url": "https://api.github.com/users/p8/orgs",
      "repos_url": "https://api.github.com/users/p8/repos",
      "events_url": "https://api.github.com/users/p8/events{/privacy}",
      "received_events_url": "https://api.github.com/users/p8/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 150377,
        "node_id": "MDU6TGFiZWwxNTAzNzc=",
        "url": "https://api.github.com/repos/rails/rails/labels/docs",
        "name": "docs",
        "color": "02d7e1",
        "default": false,
        "description": null
      }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 4,
    "created_at": "2020-07-18T10:03:34Z",
    "updated_at": "2020-07-18T10:27:54Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
      "url": "https://api.github.com/repos/rails/rails/pulls/39871",
      "html_url": "https://github.com/rails/rails/pull/39871",
      "diff_url": "https://github.com/rails/rails/pull/39871.diff",
      "patch_url": "https://github.com/rails/rails/pull/39871.patch"
    },
    "body": "### Summary\r\n\r\nInstead of carefully selecting the code in examples to copy it, use a copy button\r\nfor copying the code. This uses https://clipboardjs.com/ for copying.\r\nFor the bash code examples only lines starting with $ prompt are copied.\r\nThe $ prompt itself is not copied.\r\n\r\nSo for the following only `ruby --version` is copied.\r\n\r\n<img width=\"652\" alt=\"image\" src=\"https://user-images.githubusercontent.com/28561/87850189-a557fc80-c8ee-11ea-98f3-9fd566c004c3.png\">\r\n",
    "performed_via_github_app": null
  }
]
